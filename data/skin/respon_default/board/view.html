{#header}
<!-- <script type="text/javascript" src="/lib/js/common_board.js"></script> -->
<script type="text/javascript" src="{js}/js/common_board.js"></script>
<script type="text/javascript" >
	var Common_Board = new common_board({
		code : "{board_info['code']}",
		no : "{board_view['board_view']['no']}",
		is_login : "{=defined('_IS_LOGIN')}",
		nonMember_title : "{terms['nonMember']['title']}",
	});

	$(function() {
		$("form[name='comment_frm']").validate({
			rules : {
				name : {required : true},
				password : {required : true, rangelength : [4, 20]},
				//content : {required : {depends : function(){return !getSmartEditor("comment");}}},
				content : {required : true},
				file : {}
			}, messages : {
				name : {required : "작성자를 입력해주세요."},
				password : {required : "비밀번호를 입력해주세요.", rangelength: $.validator.format("비밀번호는 {0}~{1}자입니다.")},
				content : {required : "내용을 입력해주세요."},
				file : {}
			}
		});
	});

	function comment_modify_display(idx, is_display) {
		var display_comment = $("#display_comment_"+ idx);

		if(is_display) {
			$("#modify_comment_content_"+ idx +", #modify_comment_btn_"+ idx, display_comment).removeClass("hide");
			$("#view_comment_btn_"+ idx + ", #view_comment_content_"+ idx, display_comment).addClass("hide");
		} else {
			$("#modify_comment_content_"+ idx +", #modify_comment_btn_"+ idx, display_comment).addClass("hide");
			$("#view_comment_btn_"+ idx + ", #view_comment_content_"+ idx, display_comment).removeClass("hide");
		}
	}

	function comment_modify_check(idx, is_secret) {
		var display_comment = $("#display_comment_"+ idx);
		$("[name='mode_"+ idx +"']", display_comment).val("modify");

		if(is_secret == 'y') {
			comment_modify_display(idx, true);
		} else {
			$("#layer_password_"+ idx, display_comment).addClass("modify").removeClass("hide").find(":password").focus();
		}
	}

	function comment_delete_check(idx, is_secret) {
		var display_comment = $("#display_comment_"+ idx);
		$("[name='mode_"+ idx +"']", display_comment).val("delete");

		if(is_secret == 'y') {
			Common_Board.board_comment_delete(idx);
		} else {
			$("#layer_password_"+ idx, display_comment).removeClass("modify").removeClass("hide").find(":password").focus();
		}
	}

	function comment_password_layer_close(idx) {
		var display_comment = $("#display_comment_"+ idx);
		$("#layer_password_"+ idx).addClass("hide");
		$("[name='password_"+ idx +"']", display_comment).val("");
	}

	function comment_password_enter(idx) {
		if (event.keyCode == 13) {
			Common_Board.board_comment_password_check(idx);
		}
	}
</script>
<div class="sub_content">
	<div class="sub_board">
		<div class="bbs_view">
			<div class="view_tit">
				<h3><!--{ ? board_view['board_view']['preface'] }-->[{board_view['board_view']['preface']}] <!--{ / }-->{board_view['board_view']['title']}</h3>
                <!--{ ? board_info['code'] == 'content'}-->
                    <p>{=date("Y.m.d", strtotime(board_view.board_view.fdate))}</p>
                <!--{ / }-->
			</div>
			<!--{ ? board_info['yn_mobile'] == 'y' || board_info['yn_email'] == 'y' }-->
			<div class="view_etc dn">
				<!--{ ? board_info['yn_mobile'] == 'y' }--><span><em>연락처</em>{board_view['board_view']['mobile']}</span><!--{ / }-->
				<!--{ ? board_info['yn_email'] == 'y' }--><span><em>이메일</em>{board_view['board_view']['email']}</span><!--{ / }-->
			</div>
			<!--{ / }-->
            <!--{ ? board_info['code'] != 'diagnosis'}-->
			<div class="yui3-cssreset view_box">
                    <!--{ ? board_info['yn_video'] == 'y' }-->
                    <div class="view_video">{=htmlspecialchars_decode(board_view['board_view']['video_html'])}</div>
                    <!--{ / }-->
                    <!--{ ? board_info['thumbnail'] == 'y' }-->
                        <!--{ ? !empty(board_view['board_view']['board_file']['thumbnail']) }-->
                            <div class="thumb_img_wrap">
                                <!--{ @ board_view['board_view']['board_file']['thumbnail'] }-->
                                    <!--{ ? board_view['board_view']['board_file']['thumbnail'][.key_]['fname'] == board_view['board_view']['thumbnail_image']}--><!-- //대표 썸네일 제외시 사용 -->
                                        <img src="{C._UPLOAD}/board/{board_view['board_view']['upload_path']}/{board_view['board_view']['thumbnail_image']}" alt=""/>
                                    <!--{ : }-->
                                        <img src="{C._UPLOAD}/board/{board_view['board_view']['upload_path']}/{board_view['board_view']['board_file']['thumbnail'][.key_]['fname']}" alt=""/>
                                    <!--{ / }-->
                                <!--{ / }-->
                            </div>
                        <!--{ / }-->
                    <!--{ / }-->
                    <!--{ ? board_info.yn_editor === "y" }-->
                    {=htmlspecialchars_decode(board_view['board_view']['content'])}
                    <!--{ : }-->
                    { =nl2br(board_view.board_view.content) }
                    <!--{ / }-->
                <!--{ ? board_info['files'] == 'y' }-->
				<!--{ ? !empty(board_view['board_view']['board_file']['file']) }-->
					<div class="extra_editor_wrap">
						<h4>첨부파일</h4>
						<div class="extra_cont">
							<!--{ @ board_view['board_view']['board_file']['file'] }-->
							<span><a href="/fileRequest/download?file={=urlencode('/board/'+ board_view['board_view']['upload_path'] +'/'+ board_view['board_view']['board_file']['file'][.key_]['fname'])}&save={=urlencode(board_view['board_view']['board_file']['file'][.key_]['oname'])}" target="_blank" download>{board_view['board_view']['board_file']['file'][.key_]['oname']}</a></span>
							<!--{ / }-->
						</div>
					</div>
				<!--{ / }-->
			<!--{ / }-->
			</div>
            <!--{ / }-->

			<!--{ ? board_info['thumbnail'] == 'y' }-->
				<!--{ ? !empty(board_view['board_view']['board_file']['thumbnail']) }-->
				<h4 class="dn">
					<span>썸네일</span>
					<!--{ @ board_view['board_view']['board_file']['thumbnail'] }-->
						<a href="/fileRequest/download?file={=urlencode('/board/'+ board_view['board_view']['upload_path'] +'/'+ board_view['board_view']['board_file']['thumbnail'][.key_]['fname'])}&save={=urlencode(board_view['board_view']['board_file']['thumbnail'][.key_]['oname'])}" target="_blank" style="color:cornflowerblue;" download>{board_view['board_view']['board_file']['thumbnail'][.key_]['oname']}<!--{ ? board_view['board_view']['board_file']['thumbnail'][.key_]['fname'] == board_view['board_view']['thumbnail_image']}--> (대표)<!--{ / }--></a>
					<!--{ / }-->
				</h4>
				<!--{ / }-->
			<!--{ / }-->
			<!--예비필드 노출-->
			<!--{ ? board_info['extraFl'] == 'y' && extraFieldData }-->
				<!--{ @ extraFieldData }-->
					<div class="extra_editor_wrap">
						<h4>{=.name}</h4>
						<div class="extra_cont <!--{ ? .type == 'editor' }-->view_cont yui3-cssreset<!--{ / }-->">
							<!--{ ? .type == 'all' }-->
							<a href="{=.link}&save={=urlencode(.original_file_name)}" style="color:cornflowerblue;" download/>{=.original_file_name}</a>
							<!--{ : .type == 'video' }-->
							<video id="" src="{=.link}" controls width="100%"></video>
							<!--{ : }-->
							{=.value}
							<!--{ / }-->
						</div>
					</div>
				<!--{ / }-->
			<!--{ / }-->
		</div><!--bbs_view-->
		<!--{ ? board_info['QNA_BOARD'] == board_info['board_type'] }-->
			<!--{ ? board_view['board_view']['answer_status'] == 'y' }-->
			<!-- 답변 내용 -->
			<div class="bbs_view">
				<div class="view_tit">
					<h3>{board_view['board_view']['answer_title']}</h3>
				</div>
				<div class="view_cont yui3-cssreset">{=htmlspecialchars_decode(board_view['board_view']['answer_content'])}</div><!--view_cont-->
			</div><!--bbs_view-->
			<!--{ / }-->
		<!--{ / }-->
		<!--{ ? board_info['comment'] == 'y' }-->
			<!--{ ? board_view['is_comment_write'] }-->
			{=form_open('', 'name=comment_frm')}
			<fieldset>
				<legend>게시글에대한 코멘트 작성</legend>
				<div class="board_comment">
					<div class="comment_name clear">
						<span>이름<input type="text" name="name" id="name" value="<!--{ ? defined('_IS_LOGIN') }-->{member['name']}<!--{ / }-->" { ? defined('_IS_LOGIN') }readonly{ / }/><label for="name" class="dn">코멘트 작성자</label></span>
						<!--{ ? !defined('_IS_LOGIN') }--><span>비밀번호<input type="password" name="password" id="password" label="비밀번호"><label for="password" class="dn">비밀번호 : </label></span><!--{ / }-->
					</div>
					<div class="comment_memo clear">
						<textarea name="content" allowBlank="false" label="댓글" title="댓글 내용을 작성헤주세요." ></textarea>
						<input type="hidden" name="file_fname" />
						<input type="hidden" name="file_oname" />
						<a href="javascript://" onclick="Common_Board.board_comment_write(document.comment_frm);" class="btn_lg btn_point">댓글달기</a>
					</div>
					<!--{ ? !defined('_IS_LOGIN') }-->
					<!-- 개인정보 수집항목 동의 -->
					<div class="policy_cont">
						<div>
							<input type="checkbox" name="nonMember" id="checkbox-nonMember" />
							<label for="checkbox-nonMember">{terms['nonMember']['title']}</label>
							<a href="/service/usepolicy" target="_blank" class="btn_sm btn_info">전체보기 ></a>
						</div>
						<textarea readonly cols="30" rows="5" align="left" title="개인정보 수집항목">{terms['nonMember']['text']}</textarea>
					</div><!-- .policy_cont -->
					<!--{ / }-->
				</div><!-- .board_comment -->
			</fieldset>
			{=form_close()}
			<!--{ / }-->
			<!--{ ? isset(board_view['board_list_comment']) }-->
			<div class="board_comment_list">
				<div class="comment_title">댓글 <span>{board_view['total_rows_comment']}</span>개</div>
				<!--{ @ board_view['board_list_comment'] }-->
				<div class="comment" id="display_comment_{.idx}">
					<input type="hidden" name="idx_{.idx}" value="{.idx}" />
					<input type="hidden" name="mode_{.idx}" value="" />
					<div class="clear">
						<div class="comment_writer">{.name} <span class="board_line"></span> {.regdt}</div>
						<div class="com_btn">
							<div id="view_comment_btn_{.idx}">
								<!--{ ? .is_comment_modify == 'y' || .is_comment_modify == 's'}-->
								<a class="btn_more" href="javascript://" onclick="comment_modify_check('{.idx}', '{.is_comment_modify}');">수정</a>
								<span class="board_line"></span>
								<!--{ / }-->

								<!--{ ? .is_comment_delete == 'y' || .is_comment_delete == 's' }-->
								<a class="btn_more" href="javascript://" onclick="comment_delete_check('{.idx}', '{.is_comment_delete}')">삭제</a>
								<!--{ / }-->

								<!--{ ? .is_comment_modify == 's' || .is_comment_delete == 's' }-->
								<div id="layer_password_{.idx}" class="comment_password hide">
									<span>비밀번호</span>
									<input type="password" name="password_{.idx}" onkeyup="comment_password_enter('{.idx}');" />
									<a href="javascript://" onclick="Common_Board.board_comment_password_check('{.idx}');" class="btn_sm btn_info">확인</a>
									<a class="close" href="javascript://" onclick="comment_password_layer_close('{.idx}');">닫기</a>
								</div>
								<!--{ / }-->
							</div>
							<div id="modify_comment_btn_{.idx}" class="hide" >
								<a href="javascript://" onclick="comment_modify_display('{.idx}', false);comment_password_layer_close('{.idx}');">취소</a>
							</div>
						</div>
					</div>
					<div id="view_comment_content_{.idx}"class="com_txt">{=htmlspecialchars_decode(.content)}</div>
					<div id="modify_comment_content_{.idx}" class="com_modify hide">
						<textarea name="content_{.idx}" title="댓글을 수정해주세요">{=htmlspecialchars_decode(.content)}</textarea>
						<input type="hidden" name="name_{.idx}" value="{.name}" />
						<input type="hidden" name="password_{.idx}" />
						<input type="hidden" name="file_fname_{.idx}" />
						<input type="hidden" name="file_oname_{.idx}" />
						<a href="javascript://" onclick="Common_Board.board_comment_modify('{.idx}')" class="btn_lg btn_default">수정</a>
					</div>
					<div class="com_txt_reply hide"></div>
				</div>
				<!--{ / }-->
			</div>
			<!--{ / }-->
		<!--{ / }-->
		<div class="view_btn">
			<div class="btn_wrap ta_left">
                <!--{ ? board_info['code'] != 'diagnosis'}-->
				<a href="/board/board_list?code={board_info['code']}" class="btn">목록으로</a>
                <!--{ / }-->
				<!--{ ? board_view['is_modify'] == 'y' }-->
				<a href="/board/board_write?code={board_info['code']}&no={board_view['board_view']['no']}" class="btn_basic btn">수정</a>
				<!--{ : board_view['is_modify'] == 's' }-->
				<a href="/board/board_secret?code={board_info['code']}&no={board_view['board_view']['no']}&page=write" class="btn_basic btn">수정</a>
				<!--{ / }-->
				<!--{ ? board_view['is_delete'] == 'y' }-->
				<a href="/board/board_delete?code={board_info['code']}&no={board_view['board_view']['no']}" class="btn_basic btn">삭제</a>
				<!--{ : board_view['is_modify'] == 's' }-->
				<a href="/board/board_secret?code={board_info['code']}&no={board_view['board_view']['no']}&page=delete" class="btn_basic btn">삭제</a>
				<!--{ / }-->
				<!--{ ? board_info['tree'] == 'y' }-->
				<!--{ ? board_view['is_answer_write'] == 'y' }-->
				<a href="/board/board_write?code={board_info['code']}&no={board_view['board_view']['no']}&cref={board_view['board_view']['no']}" class="btn_basic btn">답글</a>
				<!--{ / }-->
				<!--{ / }-->
				<!--{ ? board_info['QNA_BOARD'] == board_info['board_type'] }-->
				<!--{ ? board_info['is_inquire_answer'] }-->
				<a href="/board/board_write?code={board_info['code']}&no={board_view['board_view']['no']}&answer_status={board_view['board_view']['answer_status']}" class="btn_basic btn"><!--{ ? board_view['board_view']['answer_status'] == "y" }-->답변수정<!--{ : }-->답변등록<!--{ / }--></a>
				<!--{ / }-->
				<!--{ / }-->
			</div>
		</div><!--view_btn-->
	</div>
</div>
{#footer}